<header class="fixed top-0 left-0 w-full bg-white border-b border-gray-200 shadow-sm z-50">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="flex h-16 items-center justify-between">

      <!-- Logo i Títol -->
      <div class="flex items-center gap-3">
        <img src="assets/logo.png" alt="Logo Pla d'Evacuació" class="h-14 w-auto" />
        <div class="hidden sm:flex flex-col">
          <h1 class="text-base lg:text-lg font-semibold text-gray-900">Institut Lacetània · Pla d'Evacuació</h1>
          <p class="text-xs text-gray-600">Sistema de Gestió d'Emergències</p>
        </div>
      </div>

      <!-- Desktop Navigation - Usuari NO loguejat -->
      <nav *ngIf="!signal.isLoggedIn()" class="hidden md:flex items-center gap-3">
        <button routerLink="/login"
          class="inline-flex h-10 items-center justify-center rounded-lg border border-gray-300 bg-white px-5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
          Iniciar sessió
        </button>
        <button routerLink="/registrar" disabled 
          class="inline-flex h-10 items-center justify-center rounded-lg bg-blue-600 px-5 text-sm font-medium text-white shadow-sm transition-colors disabled:cursor-not-allowed disabled:bg-blue-400 disabled:opacity-60">
          Registrar-se
        </button>
      </nav>

      <!-- Desktop Navigation - Usuari loguejat -->
      <nav *ngIf="signal.isLoggedIn()" class="hidden lg:flex items-center gap-2">
        <!-- Navegació principal -->
        <button routerLink="/home" routerLinkActive="bg-blue-50 text-blue-700 border-blue-300"
          class="inline-flex h-10 items-center justify-center rounded-lg border border-transparent px-4 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors">
          <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          Inici
        </button>

        <button routerLink="/spaces" routerLinkActive="bg-blue-50 text-blue-700 border-blue-300"
          class="inline-flex h-10 items-center justify-center rounded-lg border border-transparent px-4 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors">
          <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
          </svg>
          Zones
        </button>

        <button routerLink="/evacuation" routerLinkActive="bg-blue-50 text-blue-700 border-blue-300"
          class="inline-flex h-10 items-center justify-center rounded-lg border border-transparent px-4 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors">
          <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          Historial
        </button>

        <!-- Separador -->
        <div class="h-8 w-px bg-gray-300 mx-2"></div>

        <!-- Botó d'evacuació destacat -->
        <button (click)="toggleEvacuacio()" 
          [ngClass]="evacuations.evacuationStarted()
            ? 'bg-amber-500 hover:bg-amber-600 focus:ring-amber-500 animate-pulse'
            : 'bg-red-600 hover:bg-red-700 focus:ring-red-600'"
          class="inline-flex h-10 items-center justify-center rounded-lg px-5 text-sm font-semibold text-white shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all">
          <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
          </svg>
          {{ evacuations.evacuationStarted() ? 'Aturar' : 'Iniciar' }}
        </button>

        <!-- Separador -->
        <div class="h-8 w-px bg-gray-300 mx-2"></div>

        <!-- Accions de compte -->
        <button routerLink="/change-password"
          class="inline-flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 shadow-sm hover:bg-gray-50 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
          title="Canviar Contrasenya">
          <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
          </svg>
        </button>

        <button (click)="logout()"
          class="inline-flex h-10 items-center justify-center rounded-lg border border-gray-300 bg-white px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-red-50 hover:border-red-300 hover:text-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors">
          <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
          Sortir
        </button>
      </nav>

      <!-- Mobile menu button -->
      <button *ngIf="signal.isLoggedIn()" (click)="mobileMenuOpen = !mobileMenuOpen"
        class="lg:hidden inline-flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
        <svg *ngIf="!mobileMenuOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
        <svg *ngIf="mobileMenuOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      <!-- Mobile menu button - No loguejat -->
      <button *ngIf="!signal.isLoggedIn()" (click)="mobileMenuOpen = !mobileMenuOpen"
        class="md:hidden inline-flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500">
        <svg *ngIf="!mobileMenuOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
        <svg *ngIf="mobileMenuOpen" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

    </div>

    <!-- Mobile Navigation - Usuari loguejat -->
    <div *ngIf="signal.isLoggedIn() && mobileMenuOpen" class="lg:hidden border-t border-gray-200 py-4">
      <nav class="flex flex-col gap-2">
        <button routerLink="/home" (click)="mobileMenuOpen = false" routerLinkActive="bg-blue-50 text-blue-700"
          class="flex items-center w-full px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
          <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          Inici
        </button>

        <button routerLink="/spaces" (click)="mobileMenuOpen = false" routerLinkActive="bg-blue-50 text-blue-700"
          class="flex items-center w-full px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
          <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
          </svg>
          Control Zones
        </button>

        <button routerLink="/evacuation" (click)="mobileMenuOpen = false" routerLinkActive="bg-blue-50 text-blue-700"
          class="flex items-center w-full px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
          <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          Historial d'Evacuacions
        </button>

        <div class="h-px bg-gray-200 my-2"></div>

        <button (click)="toggleEvacuacio(); mobileMenuOpen = false" 
          [ngClass]="evacuations.evacuationStarted()
            ? 'bg-amber-500 hover:bg-amber-600 text-white'
            : 'bg-red-600 hover:bg-red-700 text-white'"
          class="flex items-center justify-center w-full px-4 py-3 text-sm font-semibold rounded-lg shadow-md transition-colors">
          <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
          </svg>
          {{ evacuations.evacuationStarted() ? 'Aturar evacuació' : 'Iniciar evacuació' }}
        </button>

        <div class="h-px bg-gray-200 my-2"></div>

        <button routerLink="/change-password" (click)="mobileMenuOpen = false"
          class="flex items-center w-full px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
          <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
          </svg>
          Canviar Contrasenya
        </button>

        <button (click)="logout(); mobileMenuOpen = false"
          class="flex items-center w-full px-4 py-3 text-sm font-medium text-red-700 rounded-lg hover:bg-red-50 transition-colors">
          <svg class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
          </svg>
          Tancar Sessió
        </button>
      </nav>
    </div>

    <!-- Mobile Navigation - Usuari NO loguejat -->
    <div *ngIf="!signal.isLoggedIn() && mobileMenuOpen" class="md:hidden border-t border-gray-200 py-4">
      <nav class="flex flex-col gap-2">
        <button routerLink="/login" (click)="mobileMenuOpen = false"
          class="w-full px-4 py-3 text-sm font-medium text-gray-700 rounded-lg border border-gray-300 hover:bg-gray-50 transition-colors">
          Iniciar sessió
        </button>
        <button routerLink="/registrar" disabled (click)="mobileMenuOpen = false"
          class="w-full px-4 py-3 text-sm font-medium text-white rounded-lg bg-blue-600 hover:bg-blue-700 transition-colors disabled:bg-blue-400 disabled:cursor-not-allowed">
          Registrar-se
        </button>
      </nav>
    </div>

  </div>
</header>

<app-notifications></app-notifications>

<main class="pt-16">
  <router-outlet></router-outlet>
</main>